<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Layers | Elegant and informative maps with tmap</title>
  <meta name="description" content="This is a book in progress about the tmap package." />
  <meta name="generator" content="bookdown 0.21.4 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Layers | Elegant and informative maps with tmap" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book in progress about the tmap package." />
  <meta name="github-repo" content="mtennekes/tmap_book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Layers | Elegant and informative maps with tmap" />
  
  <meta name="twitter:description" content="This is a book in progress about the tmap package." />
  

<meta name="author" content="Martijn Tennekes, Jakub Nowosad" />


<meta name="date" content="2020-11-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tmshape.html"/>
<link rel="next" href="othertypes.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<!-- a placeholder for a google analytics script -->
<script>
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">tmap: elegant and effective thematic maps in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-contribute"><i class="fa fa-check"></i>How to contribute?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what-is-tmap"><i class="fa fa-check"></i><b>1.1</b> What is <strong>tmap</strong>?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#thematic-maps"><i class="fa fa-check"></i><b>1.2</b> Thematic maps</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="geodata.html"><a href="geodata.html"><i class="fa fa-check"></i><b>2</b> Spatial data in R</a><ul>
<li class="chapter" data-level="2.1" data-path="geodata.html"><a href="geodata.html#intro-geodata"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="geodata.html"><a href="geodata.html#data-models"><i class="fa fa-check"></i><b>2.2</b> Data models</a><ul>
<li class="chapter" data-level="2.2.1" data-path="geodata.html"><a href="geodata.html#vector-data-model"><i class="fa fa-check"></i><b>2.2.1</b> Vector data model</a></li>
<li class="chapter" data-level="2.2.2" data-path="geodata.html"><a href="geodata.html#raster-data-model"><i class="fa fa-check"></i><b>2.2.2</b> Raster data model</a></li>
<li class="chapter" data-level="2.2.3" data-path="geodata.html"><a href="geodata.html#spatial-data-cubes"><i class="fa fa-check"></i><b>2.2.3</b> Spatial data cubes</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="geodata.html"><a href="geodata.html#spatial-data-representations-in-r"><i class="fa fa-check"></i><b>2.3</b> Spatial data representations in R</a><ul>
<li class="chapter" data-level="2.3.1" data-path="geodata.html"><a href="geodata.html#the-sf-package"><i class="fa fa-check"></i><b>2.3.1</b> The sf package</a></li>
<li class="chapter" data-level="2.3.2" data-path="geodata.html"><a href="geodata.html#the-stars-package"><i class="fa fa-check"></i><b>2.3.2</b> The stars package</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="geodata.html"><a href="geodata.html#crs"><i class="fa fa-check"></i><b>2.4</b> Map projections (CRS)</a><ul>
<li class="chapter" data-level="2.4.1" data-path="geodata.html"><a href="geodata.html#what-are-map-projections"><i class="fa fa-check"></i><b>2.4.1</b> What are map projections?</a></li>
<li class="chapter" data-level="2.4.2" data-path="geodata.html"><a href="geodata.html#a-model-of-the-earth"><i class="fa fa-check"></i><b>2.4.2</b> A model of the Earth</a></li>
<li class="chapter" data-level="2.4.3" data-path="geodata.html"><a href="geodata.html#platte-carrée-and-web-mercator"><i class="fa fa-check"></i><b>2.4.3</b> Platte Carrée and Web Mercator</a></li>
<li class="chapter" data-level="2.4.4" data-path="geodata.html"><a href="geodata.html#types-of-map-projections"><i class="fa fa-check"></i><b>2.4.4</b> Types of map projections</a></li>
<li class="chapter" data-level="2.4.5" data-path="geodata.html"><a href="geodata.html#which-projection-to-choose"><i class="fa fa-check"></i><b>2.4.5</b> Which projection to choose?</a></li>
<li class="chapter" data-level="2.4.6" data-path="geodata.html"><a href="geodata.html#crs-in-r"><i class="fa fa-check"></i><b>2.4.6</b> CRS in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nutshell.html"><a href="nutshell.html"><i class="fa fa-check"></i><b>3</b> <strong>tmap</strong> in a nutshell</a></li>
<li class="chapter" data-level="4" data-path="tmshape.html"><a href="tmshape.html"><i class="fa fa-check"></i><b>4</b> Specifying spatial data</a><ul>
<li class="chapter" data-level="4.1" data-path="tmshape.html"><a href="tmshape.html#shapes-and-layers"><i class="fa fa-check"></i><b>4.1</b> Shapes and layers</a></li>
<li class="chapter" data-level="4.2" data-path="tmshape.html"><a href="tmshape.html#shape-projection-bounding-box"><i class="fa fa-check"></i><b>4.2</b> Shape projection bounding box</a></li>
<li class="chapter" data-level="4.3" data-path="tmshape.html"><a href="tmshape.html#simplification"><i class="fa fa-check"></i><b>4.3</b> Simplification</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="layers.html"><a href="layers.html"><i class="fa fa-check"></i><b>5</b> Layers</a><ul>
<li class="chapter" data-level="5.1" data-path="layers.html"><a href="layers.html#visual-variables"><i class="fa fa-check"></i><b>5.1</b> Visual variables</a></li>
<li class="chapter" data-level="5.2" data-path="layers.html"><a href="layers.html#color-palettes"><i class="fa fa-check"></i><b>5.2</b> Color palettes <!--JN: I am not sure where this section should go--></a></li>
<li class="chapter" data-level="5.3" data-path="layers.html"><a href="layers.html#color-scale-styles"><i class="fa fa-check"></i><b>5.3</b> Color scale styles <!--JN: I am not sure where this section should go--></a></li>
<li class="chapter" data-level="5.4" data-path="layers.html"><a href="layers.html#sizes"><i class="fa fa-check"></i><b>5.4</b> Sizes <!--JN: I am not sure where this section should go--></a></li>
<li class="chapter" data-level="5.5" data-path="layers.html"><a href="layers.html#shapes"><i class="fa fa-check"></i><b>5.5</b> Shapes <!--JN: I am not sure where this section should go--></a></li>
<li class="chapter" data-level="5.6" data-path="layers.html"><a href="layers.html#mixing-visual-variables"><i class="fa fa-check"></i><b>5.6</b> Mixing visual variables</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="othertypes.html"><a href="othertypes.html"><i class="fa fa-check"></i><b>6</b> Other types</a></li>
<li class="chapter" data-level="7" data-path="layout.html"><a href="layout.html"><i class="fa fa-check"></i><b>7</b> Layout</a></li>
<li class="chapter" data-level="8" data-path="interactive.html"><a href="interactive.html"><i class="fa fa-check"></i><b>8</b> Interactive settings</a></li>
<li class="chapter" data-level="9" data-path="multiples.html"><a href="multiples.html"><i class="fa fa-check"></i><b>9</b> Small multiples</a></li>
<li class="chapter" data-level="10" data-path="options.html"><a href="options.html"><i class="fa fa-check"></i><b>10</b> tmap options</a></li>
<li class="chapter" data-level="11" data-path="save.html"><a href="save.html"><i class="fa fa-check"></i><b>11</b> Save maps</a></li>
<li class="chapter" data-level="12" data-path="animations.html"><a href="animations.html"><i class="fa fa-check"></i><b>12</b> Animations</a></li>
<li class="chapter" data-level="13" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>13</b> <strong>tmap</strong> in <strong>shiny</strong></a></li>
<li class="chapter" data-level="14" data-path="goodmaps.html"><a href="goodmaps.html"><i class="fa fa-check"></i><b>14</b> How to make good maps?</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://mtennekes.github.io/">Martijn Tennekes</a></li>
<li><a href="https://nowosad.github.io/">Jakub Nowosad</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Elegant and informative maps with <strong>tmap</strong></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="layers" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Layers</h1>
<p><a href="layers.html#tab:layers-table">5.1</a></p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:layers-table">TABLE 5.1: </span>Map layers.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Function
</th>
<th style="text-align:left;">
Element
</th>
<th style="text-align:left;">
Geometry
</th>
</tr>
</thead>
<tbody>
<tr grouplength="5">
<td colspan="3" style="border-bottom: 1px solid;">
<strong>Basic functions</strong>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_polygons()
</td>
<td style="text-align:left;">
polygons (borders and fill)
</td>
<td style="text-align:left;">
polygons
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_symbols()
</td>
<td style="text-align:left;">
symbols
</td>
<td style="text-align:left;">
points, polygons, and lines
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_lines()
</td>
<td style="text-align:left;">
lines
</td>
<td style="text-align:left;">
lines
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_raster()
</td>
<td style="text-align:left;">
raster
</td>
<td style="text-align:left;">
raster
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_text()
</td>
<td style="text-align:left;">
text
</td>
<td style="text-align:left;">
points, polygons, and lines
</td>
</tr>
<tr grouplength="8">
<td colspan="3" style="border-bottom: 1px solid;">
<strong>Derived functions</strong>
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_borders()
</td>
<td style="text-align:left;">
polygons (borders)
</td>
<td style="text-align:left;">
polygons
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_fill()
</td>
<td style="text-align:left;">
polygons (fill)
</td>
<td style="text-align:left;">
polygons
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_bubbles()
</td>
<td style="text-align:left;">
bubbles
</td>
<td style="text-align:left;">
points, polygons, and lines
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_dots()
</td>
<td style="text-align:left;">
dots
</td>
<td style="text-align:left;">
points, polygons, and lines
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_markers()
</td>
<td style="text-align:left;">
marker symbols
</td>
<td style="text-align:left;">
points, polygons, and lines
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_square()
</td>
<td style="text-align:left;">
squares
</td>
<td style="text-align:left;">
points, polygons, and lines
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_iso()
</td>
<td style="text-align:left;">
lines with text labels
</td>
<td style="text-align:left;">
lines
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;font-family: monospace; padding-left:  2em;" indentlevel="1">
tm_rgb()/tm_rgba()
</td>
<td style="text-align:left;">
raster (RGB image)
</td>
<td style="text-align:left;">
raster
</td>
</tr>
</tbody>
</table>
<div id="visual-variables" class="section level2">
<h2><span class="header-section-number">5.1</span> Visual variables</h2>
<p>Visual variables are methods to translate information given in variables into many types of visualizations, including maps.
Basic visual variables are color, size, and shape<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>.
All of them can influence our perception and understanding of the presented information, therefore it is worth to understand when and how they can be used.</p>
<div class="figure" style="text-align: center"><span id="fig:visual-variables"></span>
<img src="05-layers_files/figure-html/visual-variables-1.png" alt="Basic visual variables and their representations on maps" width="672" />
<p class="caption">
FIGURE 5.1: Basic visual variables and their representations on maps
</p>
</div>
<p>The use of visual variables on maps depends on two main things: (a) type of the presented variable, and (b) type of the map layer.
Figure <a href="layers.html#fig:visual-variables">5.1</a> shows examples of different visual variables.
Color is the most universal visual variable.
It can represent both qualitative (categorical) and quantitative (numerical) variables, and also we can color symbols, lines, or polygon fillings (sections <a href="layers.html#color-palettes">5.2</a> and <a href="layers.html#color-scale-styles">5.3</a>).
Sizes, on the other hand, should focus on quantitative variables.
Small symbols could represent low values of a given variable, and the higher the value, the larger the symbol.
Quantitative values of line data can be shown with the widths of the lines (section <a href="layers.html#sizes">5.4</a>).
The use of shapes usually should be limited to qualitative variables, and different shapes can represent different categories of points (section <a href="layers.html#shapes">5.5</a>).
<!--JN: line type is it a shape or should we make a new group-->
Similarly, qualitative variables in lines can be presented by different line types.
Values of polygons usually cannot be represented by either shapes or sizes, as these two features are connected to the geometries of the objects.
<!-- exception - cartograms - ref to other chapter \@ref(other-types) --></p>
<!-- also, sometimes it is possible to use several visual variables at the same time (e.g. width lines + colors) -->
</div>
<div id="color-palettes" class="section level2">
<h2><span class="header-section-number">5.2</span> Color palettes <!--JN: I am not sure where this section should go--></h2>
<p>
<!-- reference this bp - https://earthobservatory.nasa.gov/blogs/elegantfigures/2013/08/06/subtleties-of-color-part-2-of-6/ --></p>
<p>
Colors, along with sizes and shapes, are the most often used to express values of attributes or their properties.
Proper use of colors draws the attention of viewers and has a positive impact on the clarity of the presented information.
On the other hand, poor decisions about colors can lead to misinterpretation of the map.</p>
<!-- As we discussed in ..., -->
<!-- We can express values of attributes in spatial data using colors, shapes, or sizes. -->
<!-- https://en.wikipedia.org/wiki/Color_scheme -->
<p>

Colors in R are created based either on the color name or its hexadecimal form.
R understands 657 built-in color names, such as <code>"red"</code>, <code>"lightblue"</code> or <code>"gray90"</code>, that are available using the <code>colors()</code> function.
<!-- demo("colors") -->
<!-- http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf -->
Hexadecimal form, on the other hand, can represent 16,777,216 unique colors.
It consists of six-digits prefixed by the <code>#</code> (hash) symbol, where red, green, and blue values are each represented by two characters.
In hexadecimal form, <code>00</code> is interpreted as <code>0.0</code> which means a lack of a particular color and <code>FF</code> means <code>1.0</code> and shows that the given color has maximal intensity.
For example, <code>#000000</code> represents black color, <code>#FFFFFF</code> white color, and <code>#00FF00</code> green color.
<!-- hex alpha?? --></p>
<p>Using a single color we are able to draw points, lines, polygon borders, or their areas.
In that scenario, all of the elements will have the same color.
However, often we want to represent different values in our data using different colors.
This is a role for color palettes.
A color palette is a set of colors used to distinguish the values of variables on maps.</p>
<p>
Color palettes in R are usually stored as a vector of either color names or hexadecimal representations.
For example, <code>c("red", "green", "blue")</code> or <code>c("#66C2A5", "#FC8D62", "#8DA0CB")</code>.
It allows every one of us to create our own color palettes.
However, the decision on how to decide which colors to use is not straightforward, and usually requires thinking about several aspects.</p>
<p>
Firstly, what kind of variable we want to show?
<!-- a next sentence is a simplification, as always -->
Is it a <!--qualitative-->categorical variable where each value represents a <!--orderless-->group or a <!--quantitative-->numerical variable in which values have order?
<!-- http://colorspace.r-forge.r-project.org/articles/palette_visualization.html -->
The variable type impacts how it should be presented on the map.
For categorical variables, each color usually should receive the same perceptual weight, which is done by using colors with the same brightness<!--luminance-->, but different hue<!--type of color-->.
On the other hand, for numerical variables, we should easily understand which colors represent lower and which represent higher values.
This is done by manipulating colorfulness<!--chroma,saturation--> and brightness<!--luminance-->.
For example, low values could be presented by a blue color with low colorfulness and high brightness, and with growing values, colorfulness increases and brightness decreases.</p>
<p>
Next consideration is related to how people <!--(reader/viewers)--> perceive some colors.
Usually, we want them to be able to preliminary understand which values the colors represent without looking at the legend – colors should be intuitive.
For example, in the case of categorical variables representing land use, we usually want to use some type of blue color for rivers, green for trees, and white for ice.
This idea also extends to numerical variables, where we should think about the association between colors and cultural values.
The blue color is usually connected to cold temperature, while the red color is hot or can represent danger or something not good.
However, we need to be aware that the connection between colors and cultural values varied between cultures.
<!-- http://uxblog.idvsolutions.com/2013/07/language-and-color.html --></p>
<p>
Another thing to consider is to use a color palette that is accessible for people with color vision deficiencies (color blindness).
<!-- https://en.wikipedia.org/wiki/Color_blindness -->
There are several types of color blindness, with the red-green color blindness (<em>deuteranomaly</em>) being the most common.
It is estimated that up to about 8% of the male population and about 0.5% of the female population in some regions of the world is color blind <span class="citation">(Birch <a href="#ref-birch_worldwide_2012" role="doc-biblioref">2012</a>; Sharpe et al. <a href="#ref-sharpe_opsin_1999" role="doc-biblioref">1999</a>)</span>.
<!-- tools in R for checking for colorblindness --></p>
<!-- Simultaneous contrast. -->
<!-- background -->
<p>The relation between the selected color palette and other map elements or the map background should be also taken into a consideration.
For example, using a bright or dark background color on a map has an impact on how people will perceive different color palettes.
<!-- relation between the background col and other colors -->
<!-- using two or more palettes (e.g. lines and points): -->
<!-- color palettes then should be complementary --></p>
<!-- should we add: (?) -->
<!-- aesthetic -->
<!-- similar to lines types, fonts, etc, positions -->
<!-- hard to grasp, hard to learn, look for good examples and be inspired -->
<p>
Generally, color palettes can be divided into three main types (Figure <a href="layers.html#fig:palette-types">5.2</a>):</p>
<ul>
<li><strong>Categorical</strong> (also known as Qualitative) - used for presenting categorical information, for example, categories or groups.
Every color in this type of palettes should receive the same perceptual weight, and the order of colors is meaningless.
Categorical color palettes are usually limited to dozen or so different colors, as our eyes have problems with distinguishing a large number of different hues.
Their use includes, for example, regions of the world or land cover categories.</li>
<li><strong>Sequential</strong> - used for presenting continuous variables, in which order matters.
Colors in this palette type changes from low to high (or vice versa), which is usually underlined by luminance differences (light-dark contrasts).
Sequential palettes can be found in maps of GDP, population density, elevation, and many others.</li>
<li><strong>Diverging</strong> - used for presenting continuous variables, but where colors diverge from a central neutral value to two extremes.
Therefore, in sense, they consist of two sequential palettes that meet in the midpoint value.
Examples of diverging palettes include maps where a certain temperature or median value of household income is use as the midpoint.
It can also be used on maps to represent difference or change as well.</li>
</ul>
<!-- idea: replace one diverging palette with the dark in the middle -->
<!-- do it, if (when) tmap has hcl.colors build-in -->
<div class="figure" style="text-align: center"><span id="fig:palette-types"></span>
<img src="05-layers_files/figure-html/palette-types-1.png" alt="Examples of three main types of color palettes: categorical, sequential, and diverging" width="672" />
<p class="caption">
FIGURE 5.2: Examples of three main types of color palettes: categorical, sequential, and diverging
</p>
</div>
<!-- idea: add bivariate/trivariate schemes (if/when implemented in tmap) -->
<p>
Gladly, a lot of work has been put on creating color palettes that are grounded in the research of perception and design.
Currently, <a href="https://github.com/EmilHvitfeldt/r-color-palettes">several dozens of R packages</a> contain hundreds of color palettes.
The most popular among them are <strong>RColorBrewer</strong> <span class="citation">(Neuwirth <a href="#ref-R-RColorBrewer" role="doc-biblioref">2014</a>)</span> and <strong>viridis</strong> <span class="citation">(Garnier <a href="#ref-R-viridis" role="doc-biblioref">2018</a>)</span>.
<strong>RColorBrewer</strong> builds upon a set of perceptually ordered color palettes <span class="citation">(Harrower and Brewer <a href="#ref-harrower_colorbrewer_2003" role="doc-biblioref">2003</a>)</span> and the associated website at <a href="https://colorbrewer2.org" class="uri">https://colorbrewer2.org</a>.
The website not only presents all of the available color palettes, but also allow to filter them based on their properties, such as being colorblind safe or print-friendly.
The <strong>viridis</strong> package has five color palettes are perceptually-uniform and suitable for people with color blindness.
Four palettes is this package (“viridis”, “magma”, “plasma”, and “inferno”) are derived from the work on the color palettes for <a href="http://bids.github.io/colormap/">the matplotlib Python library</a>.
The last one, “cividis”, is based on the work of <span class="citation">Nuñez, Anderton, and Renslow (<a href="#ref-nunez_optimizing_2018" role="doc-biblioref">2018</a>)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="layers.html#cb11-1"></a>RColorBrewer<span class="op">::</span><span class="kw">brewer.pal</span>(<span class="dv">7</span>, <span class="st">&quot;RdBu&quot;</span>)</span>
<span id="cb11-2"><a href="layers.html#cb11-2"></a><span class="co">#&gt; [1] &quot;#B2182B&quot; &quot;#EF8A62&quot; &quot;#FDDBC7&quot; &quot;#F7F7F7&quot; &quot;#D1E5F0&quot;</span></span>
<span id="cb11-3"><a href="layers.html#cb11-3"></a><span class="co">#&gt; [6] &quot;#67A9CF&quot; &quot;#2166AC&quot;</span></span>
<span id="cb11-4"><a href="layers.html#cb11-4"></a>viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">7</span>)</span>
<span id="cb11-5"><a href="layers.html#cb11-5"></a><span class="co">#&gt; [1] &quot;#440154FF&quot; &quot;#443A83FF&quot; &quot;#31688EFF&quot; &quot;#21908CFF&quot;</span></span>
<span id="cb11-6"><a href="layers.html#cb11-6"></a><span class="co">#&gt; [5] &quot;#35B779FF&quot; &quot;#8FD744FF&quot; &quot;#FDE725FF&quot;</span></span></code></pre></div>
<p>
In the last few years, the <strong>grDevices</strong> package that is an internal part of R, have received several improvements over color palette handling.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>
It includes creation of <code>hcl.colors()</code> and <code>palette.colors()</code>.
The <code>hcl.colors()</code> function <a href="http://colorspace.r-forge.r-project.org/articles/approximations.html">incorporates color palettes from several R packages</a>, including <strong>RColorBrewer</strong>, <strong>viridis</strong>, <strong>rcartocolor</strong> <span class="citation">(CARTO <a href="#ref-carto_cartocolors_2019" role="doc-biblioref">2019</a>; Nowosad <a href="#ref-R-rcartocolor" role="doc-biblioref">2018</a>)</span>, and <strong>scico</strong> <span class="citation">(Crameri <a href="#ref-crameri_geodynamic_2018" role="doc-biblioref">2018</a>; Pedersen and Crameri <a href="#ref-R-scico" role="doc-biblioref">2020</a>)</span>.
You can get the list of available palette names for <code>hcl.colors()</code> using the <code>hcl.pals()</code> function and visualize all of the palettes with <code>colorspace::hcl_palettes(plot = TRUE)</code>.
The <code>palette.colors()</code> function adds <a href="https://developer.r-project.org/Blog/public/2019/11/21/a-new-palette-for-r/index.html">several palettes for categorical data</a>.
It includes <code>"Okabe-Ito"</code> <a href="https://jfly.uni-koeln.de/color/">suited for color vision deficiencies</a> or <code>"Polychrome 36"</code> that has 36 unique colors <span class="citation">(Coombes et al. <a href="#ref-coombes_polychrome_2019" role="doc-biblioref">2019</a>)</span>.
You can find the available names of the palettes for this function using <code>palette.pals()</code></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="layers.html#cb12-1"></a>grDevices<span class="op">::</span><span class="kw">hcl.colors</span>(<span class="dv">7</span>, <span class="st">&quot;Oslo&quot;</span>)</span>
<span id="cb12-2"><a href="layers.html#cb12-2"></a><span class="co">#&gt; [1] &quot;#FCFCFC&quot; &quot;#C2CEE8&quot; &quot;#86A2D3&quot; &quot;#3C79C0&quot; &quot;#275182&quot;</span></span>
<span id="cb12-3"><a href="layers.html#cb12-3"></a><span class="co">#&gt; [6] &quot;#132B48&quot; &quot;#040404&quot;</span></span>
<span id="cb12-4"><a href="layers.html#cb12-4"></a>grDevices<span class="op">::</span><span class="kw">palette.colors</span>(<span class="dv">7</span>, <span class="st">&quot;Okabe-Ito&quot;</span>)</span>
<span id="cb12-5"><a href="layers.html#cb12-5"></a><span class="co">#&gt;       black      orange     skyblue bluishgreen </span></span>
<span id="cb12-6"><a href="layers.html#cb12-6"></a><span class="co">#&gt;   &quot;#000000&quot;   &quot;#E69F00&quot;   &quot;#56B4E9&quot;   &quot;#009E73&quot; </span></span>
<span id="cb12-7"><a href="layers.html#cb12-7"></a><span class="co">#&gt;      yellow        blue  vermillion </span></span>
<span id="cb12-8"><a href="layers.html#cb12-8"></a><span class="co">#&gt;   &quot;#F0E442&quot;   &quot;#0072B2&quot;   &quot;#D55E00&quot;</span></span></code></pre></div>
<p>
One of the most widely used color palettes is “rainbow” (the <code>rainbow()</code> function in R).
It was inspired by colors of rainbows - a set of seven colors going from red to violet.
However, this palette has a number of disadvantages, including irregular changes in brightness affecting its interpretation or being unsuitable for people with color vision deficiencies <span class="citation">(Borland and Taylor Ii <a href="#ref-borland_rainbow_2007" role="doc-biblioref">2007</a>; Stauffer et al. <a href="#ref-stauffer_somewhere_2015" role="doc-biblioref">2015</a>; Quinan et al. <a href="#ref-quinan_examining_2019" role="doc-biblioref">2019</a>)</span>.
Depending on a given situation, there are many palettes better suited for visualization than “rainbow”, including sequential <code>"viridis"</code> and <code>"ag_Sunset"</code> or diverging <code>"Purple-Green"</code> and <code>"Fall"</code>.
All of them can be created with the <code>grDevices::hcl.colors()</code> function.
More examples showing alternatives to the “rainbow” palette are in the documentation of the <strong>colorspace</strong> package at
<a href="https://colorspace.r-forge.r-project.org/articles/endrainbow.html" class="uri">https://colorspace.r-forge.r-project.org/articles/endrainbow.html</a> <span class="citation">(Zeileis et al. <a href="#ref-R-colorspace" role="doc-biblioref">2019</a>)</span>.</p>
<!-- https://github.com/mtennekes/tmap/blob/d3b8575fa19d704cff69cdac6746fedc5b8db758/R/tmap_options.R -->
<p>By default, the <strong>tmap</strong> package attempts to identify the type of the used variable.
Based on the result, it selects one of the build-in palettes: categorical <code>"Set3"</code>, sequential <code>"YlOrBr"</code>, or diverging <code>"RdYlGn"</code> (Figure <a href="layers.html#fig:tmpals">5.3</a>).
<!-- info about tm_layout or reference to a section about it --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="layers.html#cb13-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-2"><a href="layers.html#cb13-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;lifeExp&quot;</span>)</span></code></pre></div>
<p>It also offers three main ways to specify color palettes using the <code>palette</code> argument: (1) a vector of colors, (2) a palette function, or (3) one of the build-in names (Figure <a href="layers.html#fig:tmpals">5.3</a>).
A vector of colors can be specified using color names or hexadecimal representations (Figure <a href="layers.html#fig:tmpals">5.3</a>).
Importantly, the length of the provided vector does not need to be equal to the number of colors in the map legend.
<strong>tmap</strong> automatically interpolates new colors in the case when a smaller number of colors is provided.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="layers.html#cb14-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb14-2"><a href="layers.html#cb14-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;lifeExp&quot;</span>, <span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;darkgreen&quot;</span>))</span></code></pre></div>
<p>Another approach is to provide the output of a palette function (Figure <a href="layers.html#fig:tmpals">5.3</a>).
In the example below, we derived seven colors from <code>"ag_GrnYl"</code> palette.
This palette goes from green colors to yellow ones, however, we wanted to reverse the order of this palette.
Thus, we also used the <code>rev()</code> function here.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="layers.html#cb15-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb15-2"><a href="layers.html#cb15-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;lifeExp&quot;</span>, <span class="dt">palette =</span> <span class="kw">rev</span>(<span class="kw">hcl.colors</span>(<span class="dv">7</span>, <span class="st">&quot;ag_GrnYl&quot;</span>)))</span></code></pre></div>
<p>The last approach is to use one of the names of color palettes build-in in <strong>tmap</strong> (Figure <a href="layers.html#fig:tmpals">5.3</a>).
In this example, we used the <code>"YlGn"</code> palette that goes from yellow to green.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="layers.html#cb16-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb16-2"><a href="layers.html#cb16-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;lifeExp&quot;</span>, <span class="dt">palette =</span> <span class="st">&quot;YlGn&quot;</span>)</span></code></pre></div>
<p>You can find all of the named color palettes using an interactive app with <code>tmaptools::palette_explorer()</code>.
It is also possible to reverse the order of any named color palette by using the <code>-</code> prefix.
Therefore, <code>"-YlGn"</code> will return a palette going from green to yellow.</p>
<div class="figure" style="text-align: center"><span id="fig:tmpals"></span>
<img src="05-layers_files/figure-html/tmpals-1.png" alt="Examples of four ways of specifying color palettes: (A) default sequential color palette, (B) palette created based on provided vector of colors, (C) palette created using the hcl.colors function, and (D) one of the build-in palettes." width="672" />
<p class="caption">
FIGURE 5.3: Examples of four ways of specifying color palettes: (A) default sequential color palette, (B) palette created based on provided vector of colors, (C) palette created using the hcl.colors function, and (D) one of the build-in palettes.
</p>
</div>
<!-- state that the above example of setting colors works for most of palettes -->
<!-- midpoint argument -->
<p>The default color palette for positive numerical variables is <code>"YlOrBr"</code> as seen in Figure <a href="layers.html#fig:tmmidpoint">5.4</a>:A.
On the other hand, when the given variable has both negative and positive values, then <strong>tmap</strong> uses the <code>"RdYlGn"</code> color palette, with red colors below the midpoint value, yellow color around the midpoint value, and green colors above the midpoint value.
The use of diverging color palettes can be adjusted using the <code>midpoint</code> argument.
It has a value of 0 as the default, however, it is possible to change it to any other value.
For example, we want to create a map that shows countries with life expectancy below and above the median life expectancy of about 73 years.
To do that, we just need to set the <code>midpoint</code> argument to this value (Figure <a href="layers.html#fig:tmmidpoint">5.4</a>:B).
<!-- , style = "cont" --></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="layers.html#cb17-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb17-2"><a href="layers.html#cb17-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;lifeExp&quot;</span>, <span class="dt">midpoint =</span> <span class="dv">73</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:tmmidpoint"></span>
<img src="05-layers_files/figure-html/tmmidpoint-1.png" alt="Examples of (A) a map with the default sequential color palette and (B) a map with the diverging color palette around the midpoint value of 73." width="672" />
<p class="caption">
FIGURE 5.4: Examples of (A) a map with the default sequential color palette and (B) a map with the diverging color palette around the midpoint value of 73.
</p>
</div>
<p>Now the countries with low life expectancy are presented with red colors, yellow areas represent countries with life expectancy around the median value (the <code>midpoint</code> in our case), and the countries with high life expectancy are represented by green colors.</p>
<p>The above examples all contain several polygons with missing values of a given variable.
Objects with missing values are, by default, represented by gray color and a related legend label <em>Missing</em>.
However, it is possible to change this color with the <code>colorNA</code> argument and its label with <code>textNA</code>.</p>
<p><strong>tmap</strong> has a special way to set colors for categorical maps manually.
It works by providing a named vector to the <code>palette</code> argument.
In this vector, names of the categories from the categorical variable are the vector names, and specified colors are the vector values.
You can see it in the example below, where we plot the <code>"region_un"</code> categorical variable (Figure <a href="layers.html#fig:tmcatpals">5.5</a>).
Each category in this variable (e.g., <code>"Africa"</code>) has a new, connected to it color (e.g., <code>"#11467b"</code>).
<!--improve colors-->
<!-- also - improve example - maybe use less colors/categories --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="layers.html#cb18-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-2"><a href="layers.html#cb18-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="st">&quot;region_un&quot;</span>, </span>
<span id="cb18-3"><a href="layers.html#cb18-3"></a>    <span class="dt">palette =</span> <span class="kw">c</span>(</span>
<span id="cb18-4"><a href="layers.html#cb18-4"></a>      <span class="st">&quot;Africa&quot;</span> =<span class="st"> &quot;#11467b&quot;</span>,</span>
<span id="cb18-5"><a href="layers.html#cb18-5"></a>      <span class="st">&quot;Americas&quot;</span> =<span class="st"> &quot;#ffd14d&quot;</span>, </span>
<span id="cb18-6"><a href="layers.html#cb18-6"></a>      <span class="st">&quot;Antarctica&quot;</span> =<span class="st"> &quot;#86909a&quot;</span>, </span>
<span id="cb18-7"><a href="layers.html#cb18-7"></a>      <span class="st">&quot;Asia&quot;</span> =<span class="st"> &quot;#14909a&quot;</span>,</span>
<span id="cb18-8"><a href="layers.html#cb18-8"></a>      <span class="st">&quot;Europe&quot;</span> =<span class="st"> &quot;#7fbee9&quot;</span>,</span>
<span id="cb18-9"><a href="layers.html#cb18-9"></a>      <span class="st">&quot;Oceania&quot;</span> =<span class="st"> &quot;#df5454&quot;</span>,</span>
<span id="cb18-10"><a href="layers.html#cb18-10"></a>      <span class="st">&quot;Seven seas (open ocean)&quot;</span> =<span class="st"> &quot;#7b1072&quot;</span>)</span>
<span id="cb18-11"><a href="layers.html#cb18-11"></a>    )</span>
<span id="cb18-12"><a href="layers.html#cb18-12"></a><span class="co">#&gt; Some legend labels were too wide. These labels have been resized to 0.64. Increase legend.width (argument of tm_layout) to make the legend wider and therefore the labels larger.</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:tmcatpals"></span>
<img src="05-layers_files/figure-html/tmcatpals-1.png" alt="An example of a categorical map with manually selected colors" width="672" />
<p class="caption">
FIGURE 5.5: An example of a categorical map with manually selected colors
</p>
</div>
<p>
Finally, visualized colors can be additionally modified.
It includes setting the <code>alpha</code> argument that represents the transparency of the used colors.
By default, the colors are not transparent at all as the value of <code>alpha</code> is 1.
However, we can decrease this value to 0 - total transparency.
The <code>alpha</code> argument is useful in two ways: one - it allows us to see-through some large objects (e.g., some points below the polygons or a hillshade map behind the colored raster of elevation), second - it makes colors more subtle.</p>
<!-- resources: -->
<!-- https://bookdown.org/hneth/ds4psy/D-2-apx-colors-essentials.html -->
<!-- https://developer.r-project.org/Blog/public/2019/11/21/a-new-palette-for-r/index.html -->
<!-- add some references about colors theory, color blindness, etc. -->
<!-- https://earthobservatory.nasa.gov/blogs/elegantfigures/2013/09/10/subtleties-of-color-part-6-of-6/ -->
</div>
<div id="color-scale-styles" class="section level2">
<h2><span class="header-section-number">5.3</span> Color scale styles <!--JN: I am not sure where this section should go--></h2>
<!-- intro about setting colors -->
<!-- info that generalized to points, lines, polygons, and rasters... -->
<p>
<code>tm_polygons()</code> accepts three ways of specifying the fill color with the <code>col</code> argument<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>.
The first one is to fill all polygons with the same color.
This happens when we provide a single color value, either as a color name or its hexadecimal form (section <a href="layers.html#color-palettes">5.2</a>) (Figure <a href="layers.html#fig:colorscales1">5.6</a>).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="layers.html#cb19-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb19-2"><a href="layers.html#cb19-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:colorscales1"></span>
<img src="05-layers_files/figure-html/colorscales1-1.png" alt="Example of a map with all polygons filled with the same color." width="672" />
<p class="caption">
FIGURE 5.6: Example of a map with all polygons filled with the same color.
</p>
</div>
<p>



The second way of specifying the fill color is to provide a name of the column (variable) we want to visualize.
<strong>tmap</strong> behaves differently depending on the input variable type, but always automatically adds a map legend.
In general, a categorical map is created when the provided variable contains characters, factors, or is of the logical type.
However, when the provided variable is numerical, then it is possible to create either a discrete or a continuous map.</p>
<p>
An example of a categorical map can be seen in Figure <a href="layers.html#fig:colorscales2">5.7</a>.
We created it by providing a character variable’s name, <code>"region_un"</code>, in the <code>col</code> argument<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="layers.html#cb20-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb20-2"><a href="layers.html#cb20-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;region_un&quot;</span>)</span></code></pre></div>
<!-- categorical -->
<div class="figure" style="text-align: center"><span id="fig:colorscales2"></span>
<img src="05-layers_files/figure-html/colorscales2-1.png" alt="Example of a map in which polygons are colored based on the values of a categorical variable." width="672" />
<p class="caption">
FIGURE 5.7: Example of a map in which polygons are colored based on the values of a categorical variable.
</p>
</div>
<p>It is possible to change the names of legend labels with the <code>labels</code> argument.
However, to change the order of legend labels, we need to provide an ordered factor variable’s name instead of a character one.<!--should we explain how to do it?-->
As mentioned in the section <a href="layers.html#color-palettes">5.2</a>, we can also change the used color palette with the <code>palette</code> argument.</p>
<!-- optimal number of classes? 3-7 -->
<p>
Discrete maps, on the other hand, represent continuous numerical variables using discrete class intervals.
In other words, values are divided into several groups based on their properties.
Several approaches can be used to convert continuous variables to discrete ones, and each of them could result in different groups of values.
<strong>tmap</strong> has 14 different methods to create discrete maps<!--list??--> that can be specified with the <code>style</code> argument.
Most of them (except <code>"log10_pretty"</code>) use the <strong>classInt</strong> package <span class="citation">(Bivand <a href="#ref-R-classInt" role="doc-biblioref">2020</a>)</span> in the background, therefore some additional information can be found in the <code>?classIntervals</code> function’s documentation.</p>
<p>By default, the <code>"pretty"</code> style is used (Figure <a href="layers.html#fig:discrete-methods">5.8</a>:A).
This style creates breaks that are whole numbers and spaces them evenly.<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="layers.html#cb21-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb21-2"><a href="layers.html#cb21-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;gdpPercap&quot;</span>)</span></code></pre></div>
<p>It is also possible to indicate the desired number of classes using the <code>n</code> argument, when the <code>"pretty"</code> style is used.
While not every <code>n</code> is possible depending on the input values, <strong>tmap</strong> will try to create a number of classes as close to possible to the preferred one.</p>
<p>The next approach is to manually select the limits of each break with the <code>breaks</code> function (Figure <a href="layers.html#fig:discrete-methods">5.8</a>:B).
This can be useful when we have some pre-defined breaks, or when we want to compare values between several maps.
It expects threshold values for each break, therefore, if we want to have three breaks, we need to provide four thresholds.
Additionally, we can add a label to each break with the <code>labels</code> argument.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="layers.html#cb22-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb22-2"><a href="layers.html#cb22-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;gdpPercap&quot;</span>, </span>
<span id="cb22-3"><a href="layers.html#cb22-3"></a>              <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10000</span>, <span class="dv">30000</span>, <span class="dv">121000</span>),</span>
<span id="cb22-4"><a href="layers.html#cb22-4"></a>              <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;high&quot;</span>))</span></code></pre></div>
<!-- interval.closure    -->
<p>Another approach is to create breaks automatically using one of many existing classification methods.
Three basic methods are <code>"equal"</code>, <code>"sd"</code>, and <code>"quantile"</code> styles.
Let’s consider a variable with 100 observations ranging from 0 to 10.
The <code>"equal"</code> style divides the range of values into <em>n</em> equal-sized intervals.
This style works well when the values change fairly continuously and do not contain any outliers.
In <strong>tmap</strong>, we can specify the number of classes with the <code>n</code> argument or the number of classes will be computed automatically <!--?nclass.Sturges-->.
For example, when we set <code>n</code> to 4, then our breaks will represent four classes ranging from 0 to 2.5, 2.5 to 5, 5 to 7.5, and 7.5 to 10.
The <code>"sd"</code> style represents how much values of a given variable varies from its mean, with each interval having a constant width of the standard deviation.
This style is used when it is vital to show how values relate to the mean.
The <code>"quantile"</code> style creates several classes with exactly the same number of objects (e.g., spatial features), but having intervals of various lengths.
This method has an advantage or not having any empty classes or classes with too few or too many values.
However, the resulting intervals from the <code>"quantile"</code> style can often be misleading, with very different values located in the same class.</p>
<p>To create classes that, on the one hand, contain similar values, and on the other hand, are different from the other classes, we can use some optimization method.
The most common optimization method used in cartography is the Jenks optimization method implemented at the <code>"jenks"</code> style (Figure <a href="layers.html#fig:discrete-methods">5.8</a>:C).</p>
<!-- how about adding ggplot2 histograms?? -->
<!-- should we add that these methods usually do not allow to compare between datasets? -->
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="layers.html#cb23-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb23-2"><a href="layers.html#cb23-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;gdpPercap&quot;</span>, </span>
<span id="cb23-3"><a href="layers.html#cb23-3"></a>              <span class="dt">style =</span> <span class="st">&quot;jenks&quot;</span>)</span></code></pre></div>
<p>The Fisher method (<code>style = "fisher"</code>) has a similar role, which creates groups with maximized homogeneity <span class="citation">(Fisher <a href="#ref-fisher_grouping_1958" role="doc-biblioref">1958</a>)</span>.
A different approach is used by the <code>dpih</code> style, which uses kernel density estimations to select the width of the intervals <span class="citation">(Wand <a href="#ref-wand_databased_1997" role="doc-biblioref">1997</a>)</span>.
You can visit <code>?KernSmooth::dpih</code> for more details.</p>
<p>Another group of classification methods uses existing clustering methods.
It includes k-means clustering (<code>"kmeans"</code>), bagged clustering (<code>"bclust"</code>), and hierarchical clustering (<code>"hclust"</code>).
<!-- ... --></p>
<p>Finally, there are a few methods created to work well for a variable with a heavy-tailed distribution, including <code>"headtails"</code> and <code>"log10_pretty"</code>.
The <code>"headtails"</code> style is an implementation of the head/tail breaks method aimed at heavily right-skewed data.
In it, values of the given variable are being divided around the mean into two parts, and the process continues iteratively for the values above the mean (the head) until the head part values are no longer heavy-tailed distributed <span class="citation">(Jiang <a href="#ref-jiang_head_2013" role="doc-biblioref">2013</a>)</span>.
The <code>"log10_pretty"</code> style uses a logarithmic base-10 transformation (Figure <a href="layers.html#fig:discrete-methods">5.8</a>:D).
In this style, each class starts with a value ten times larger than the beginning of the previous class.
In other words, each following class shows us the next order of magnitude.
This style allows for a better distinction between low, medium, and high values.
However, maps with logarithmically transformed variables are usually less intuitive for the readers and require more attention from them.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="layers.html#cb24-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb24-2"><a href="layers.html#cb24-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;gdpPercap&quot;</span>, </span>
<span id="cb24-3"><a href="layers.html#cb24-3"></a>              <span class="dt">style =</span> <span class="st">&quot;log10_pretty&quot;</span>)</span></code></pre></div>
<!-- discrete -->
<div class="figure" style="text-align: center"><span id="fig:discrete-methods"></span>
<img src="05-layers_files/figure-html/discrete-methods-1.png" alt="Examples of four methods of creating discrete maps: (A) default method ('pretty'), (B) the 'fixed' method with manually set breaks, (C) the 'jenks' method, and (D) the 'log10_pretty' method." width="672" />
<p class="caption">
FIGURE 5.8: Examples of four methods of creating discrete maps: (A) default method (‘pretty’), (B) the ‘fixed’ method with manually set breaks, (C) the ‘jenks’ method, and (D) the ‘log10_pretty’ method.
</p>
</div>
<!-- The numeric variable can be either regarded as a continuous variable or a count (integer) variable. See as.count. Only applicable if style is "pretty", "fixed", or "log10_pretty". -->
<p>
Continuous maps also represent continuous numerical variables, but without any discrete class intervals (Figure <a href="layers.html#fig:cont-methods">5.9</a>).
Three continuous methods exist in <strong>tmap</strong>: <code>cont</code>, <code>order</code>, and <code>log10</code>.
Values change increasingly in all of them, but they differ in the relations between values and colors.</p>
<p>The <code>cont</code> style creates a smooth, linear gradient.
In other words, the change in values is proportionally related to the change in colors.
We can see that in Figure <a href="layers.html#fig:cont-methods">5.9</a>:A, where the value change from 20,000 to 40,000 has a similar impact on the color scale as the value change from 40,000 to 60,000.
The <code>cont</code> style is similar to the <code>pretty</code> one, where the values also change linearly.
The main difference between these styles is that we can see differences between, for example, values of 45,000 and 55,000 in the former, while both values have exactly the same color in the later one.
The <code>cont</code> style works well in situations where there is a large number of objects in vectors or a large number of cells in rasters, and where the values change continuously (do not have many outliers).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="layers.html#cb25-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb25-2"><a href="layers.html#cb25-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;gdpPercap&quot;</span>,</span>
<span id="cb25-3"><a href="layers.html#cb25-3"></a>              <span class="dt">style =</span> <span class="st">&quot;cont&quot;</span>)</span></code></pre></div>
<p>However, when the presented variable is skewed or have some outliers, we can use either <code>order</code> or <code>log10</code> style.
The <code>order</code> style also uses a smooth gradient with a large number of colors, but the values on the legend do not change linearly (Figure <a href="layers.html#fig:cont-methods">5.9</a>:B).
<!--JN: Martijn please check the next sentence -->
It is fairly analogous to the <code>quantile</code> style, with the values on a color scale that divides a dataset into several equal-sized groups.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="layers.html#cb26-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb26-2"><a href="layers.html#cb26-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;gdpPercap&quot;</span>,</span>
<span id="cb26-3"><a href="layers.html#cb26-3"></a>              <span class="dt">style =</span> <span class="st">&quot;order&quot;</span>)</span></code></pre></div>
<p>Finally, the <code>log10</code> style is the continuous equivalent of the <code>log10_pretty</code> style (Figure <a href="layers.html#fig:cont-methods">5.9</a>:C).</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="layers.html#cb27-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb27-2"><a href="layers.html#cb27-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;gdpPercap&quot;</span>,</span>
<span id="cb27-3"><a href="layers.html#cb27-3"></a>              <span class="dt">style =</span> <span class="st">&quot;log10&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:cont-methods"></span>
<img src="05-layers_files/figure-html/cont-methods-1.png" alt="Examples of three methods of creating continuous maps: (A) the ‘cont’ method, (B) the ‘order’ method, and (C) the ‘log10’ method." width="672" />
<p class="caption">
FIGURE 5.9: Examples of three methods of creating continuous maps: (A) the ‘cont’ method, (B) the ‘order’ method, and (C) the ‘log10’ method.
</p>
</div>
<p>The <code>tm_polygons()</code> also offer a third way of specifying the fill color.
When the <code>col</code> argument is set to <code>"MAP_COLORS"</code> then polygons will be colored in such a way that adjacent polygons do not get the same color (Figure <a href="layers.html#fig:colorscalesmc">5.10</a>).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="layers.html#cb28-1"></a><span class="kw">tm_shape</span>(x) <span class="op">+</span></span>
<span id="cb28-2"><a href="layers.html#cb28-2"></a><span class="st">  </span><span class="kw">tm_polygons</span>(<span class="dt">col =</span> <span class="st">&quot;MAP_COLORS&quot;</span>)</span></code></pre></div>
<p>In this case, it is also possible to change the default colors with the <code>palette</code> argument, but also to activate the internal algorithm to search for a minimal number of colors for visualization by setting <code>minimize = TRUE</code>.</p>
<div class="figure" style="text-align: center"><span id="fig:colorscalesmc"></span>
<img src="05-layers_files/figure-html/colorscalesmc-1.png" alt="Example of a map with adjacent polygons having different colors." width="672" />
<p class="caption">
FIGURE 5.10: Example of a map with adjacent polygons having different colors.
</p>
</div>
<p>All of the color scale styles mentioned above work not only for <code>tm_polygons()</code> - they can be also applied for <code>tm_symbols()</code> (and its derivatives - <code>tm_dots()</code>, <code>tm_bubbles()</code>, <code>tm_squares()</code>), <code>tm_lines()</code>, <code>tm_fill()</code>, and <code>tm_raster()</code>.
The <code>col</code> argument colors symbols’ fillings in <code>tm_symbols()</code>, lines in <code>tm_lines()</code>, and cells in <code>tm_rasters()</code>.</p>
<!-- one color only: -->
<!-- - tm_borders  -->
<!-- title?? -->
</div>
<div id="sizes" class="section level2">
<h2><span class="header-section-number">5.4</span> Sizes <!--JN: I am not sure where this section should go--></h2>
<p>Differences in sizes between objects are relatively easy to recognize on maps.
Sizes can be used for points, lines (line widths), or text to represent quantitative (numerical) variables, where small values are related to small objects and large values are presented by large objects.
Large sizes can be also used to attract viewers’ attention.</p>
<p>By default, <strong>t</strong>maps present points, lines, or text objects of the same size.
For example, <code>tm_symbols()</code> returns a map where each object is a circle with a consistent size<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>.
We can change the sizes of all objects using the <code>size</code> argument (Figure <a href="layers.html#fig:tmsizes">5.11</a>:A).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="layers.html#cb29-1"></a><span class="co"># replace dataset later</span></span>
<span id="cb29-2"><a href="layers.html#cb29-2"></a><span class="kw">library</span>(tmap)</span>
<span id="cb29-3"><a href="layers.html#cb29-3"></a><span class="kw">data</span>(<span class="st">&quot;metro&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;tmap&quot;</span>)</span>
<span id="cb29-4"><a href="layers.html#cb29-4"></a><span class="kw">tm_shape</span>(metro) <span class="op">+</span></span>
<span id="cb29-5"><a href="layers.html#cb29-5"></a><span class="st"> </span><span class="kw">tm_symbols</span>(<span class="dt">size =</span> <span class="fl">0.5</span>) </span></code></pre></div>
<p>On the other hand, if we provide the name of the numerical variable in the <code>size</code> argument (e.g., <code>"pop2020"</code>), then symbol sizes are scaled proportionally to the provided values.
Objects with small values will be represented by smaller circles, while larger values will be represented by larger circles (Figure <a href="layers.html#fig:tmsizes">5.11</a>:B).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="layers.html#cb30-1"></a><span class="kw">tm_shape</span>(metro) <span class="op">+</span></span>
<span id="cb30-2"><a href="layers.html#cb30-2"></a><span class="st"> </span><span class="kw">tm_symbols</span>(<span class="dt">size =</span> <span class="st">&quot;pop2020&quot;</span>) </span></code></pre></div>
<!-- numeric only -->
<!-- size.max    -->
<!-- size.lim    -->
<!-- sizes.legend    -->
<!-- sizes.legend.labels     -->
<!-- potential tmap improvement: use of size.legend instead of sizes.legend -->
<p>We can adjust size legend breaks with <code>sizes.legend</code> and the corresponding labels with <code>sizes.legend.labels</code> (Figure <a href="layers.html#fig:tmsizes">5.11</a>:C).
However, this only modifies the legend, not the related objects.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="layers.html#cb31-1"></a><span class="kw">tm_shape</span>(metro) <span class="op">+</span></span>
<span id="cb31-2"><a href="layers.html#cb31-2"></a><span class="st"> </span><span class="kw">tm_symbols</span>(<span class="dt">size =</span> <span class="st">&quot;pop2020&quot;</span>,</span>
<span id="cb31-3"><a href="layers.html#cb31-3"></a>            <span class="dt">title.size =</span> <span class="st">&quot;Population (2020)&quot;</span>,</span>
<span id="cb31-4"><a href="layers.html#cb31-4"></a>            <span class="dt">sizes.legend =</span> <span class="kw">c</span>(<span class="dv">1000000</span>, <span class="dv">10000000</span>),</span>
<span id="cb31-5"><a href="layers.html#cb31-5"></a>            <span class="dt">sizes.legend.labels =</span> <span class="kw">c</span>(<span class="st">&quot;small&quot;</span>, <span class="st">&quot;large&quot;</span>)) </span></code></pre></div>
<p>For example in the above code, we just show examples of how symbols with population of one million and 10 million looks like on the map.</p>
<div class="figure" style="text-align: center"><span id="fig:tmsizes"></span>
<img src="05-layers_files/figure-html/tmsizes-1.png" alt="Examples of three approaches for changing sizes of symbols: (A) all symbols have a consistent size of 0.5, (B) sizes of symbols depends on the values of the pop2020 variable, (C) sizes of symbols have a manually created legend." width="672" />
<p class="caption">
FIGURE 5.11: Examples of three approaches for changing sizes of symbols: (A) all symbols have a consistent size of 0.5, (B) sizes of symbols depends on the values of the pop2020 variable, (C) sizes of symbols have a manually created legend.
</p>
</div>
<p>Widths of the lines can represent values of numerical variables for line data similar to sizes of the symbols for point data.
The <code>lwd</code> argument in <code>tm_lines()</code> creates thin lines for small values and thick lines for large values of the given variable (Figure <a href="layers.html#fig:tmlwd">5.12</a>).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="layers.html#cb32-1"></a><span class="co"># replace dataset later</span></span>
<span id="cb32-2"><a href="layers.html#cb32-2"></a><span class="kw">library</span>(tmap)</span>
<span id="cb32-3"><a href="layers.html#cb32-3"></a><span class="kw">data</span>(<span class="st">&quot;rivers&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;tmap&quot;</span>)</span>
<span id="cb32-4"><a href="layers.html#cb32-4"></a><span class="kw">tm_shape</span>(rivers) <span class="op">+</span><span class="st"> </span></span>
<span id="cb32-5"><a href="layers.html#cb32-5"></a><span class="st">  </span><span class="kw">tm_lines</span>(<span class="dt">lwd =</span> <span class="st">&quot;strokelwd&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:tmlwd"></span>
<img src="05-layers_files/figure-html/tmlwd-1.png" alt="Example of a map where lines' widths represent values of the corresponding lines." width="672" />
<p class="caption">
FIGURE 5.12: Example of a map where lines’ widths represent values of the corresponding lines.
</p>
</div>
<p>In the above example, values of the <code>"strokelwd"</code> are divided into four groups and represented by four line widths.
Lines’ thickness can be change using the <code>scale</code> argument, where the value of 1 is the default, and increasing this values increases lines’ thickness.
Also, similarly to the last example of the <code>tm_symbols</code> above, it is possible to modify the lines width legend, by changing its title (<code>title.lwd</code>), categories (<code>lwd.legend</code>), and their names (<code>lwd.legend.labels</code>).</p>
<!-- how about trying some transportation examples here (and expanding them)? -->
<p>Text labels have a role to name features on a map or just to highlight some of them.
Usually, the size of text labels is consistent for the same spatial objects. <!--ref to the text label layer section-->
However, text labels can be also used to represent the values of some numerical variables.
Figure <a href="layers.html#fig:tmtextsize">5.13</a> shows an example, in which text labels show names of different metropolitan areas, while their sizes are related to the populations of the areas.
This allows us to not only locate different metropolitan areas on a map but also differentiate between less populous areas (e.g., Seattle) and more populous ones (e.g., Tokyo).</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="layers.html#cb33-1"></a><span class="co"># to update later</span></span>
<span id="cb33-2"><a href="layers.html#cb33-2"></a><span class="kw">set.seed</span>(<span class="dv">222</span>)</span>
<span id="cb33-3"><a href="layers.html#cb33-3"></a>metro2 =<span class="st"> </span>metro[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(metro), <span class="dv">30</span>), ]</span>
<span id="cb33-4"><a href="layers.html#cb33-4"></a><span class="kw">tm_shape</span>(metro2) <span class="op">+</span></span>
<span id="cb33-5"><a href="layers.html#cb33-5"></a><span class="st">  </span><span class="kw">tm_text</span>(<span class="dt">text =</span> <span class="st">&quot;name&quot;</span>, <span class="dt">size =</span> <span class="st">&quot;pop2020&quot;</span>) <span class="op">+</span></span>
<span id="cb33-6"><a href="layers.html#cb33-6"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">legend.outside =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:tmtextsize"></span>
<img src="05-layers_files/figure-html/tmtextsize-1.png" alt="Example of a map where text sizes represent populations of the given metropolitan areas." width="672" />
<p class="caption">
FIGURE 5.13: Example of a map where text sizes represent populations of the given metropolitan areas.
</p>
</div>
<!-- sizes.legend -->
<!-- sizes.legend.labels -->
<!-- sizes.legend.text -->
<!-- again - mention other map types - cartograms, hexmaps, etc., which even impact of polygon sizes -->
</div>
<div id="shapes" class="section level2">
<h2><span class="header-section-number">5.5</span> Shapes <!--JN: I am not sure where this section should go--></h2>
<!-- ??and markers -->
<!-- potential tmap improvement: do not allow to use shape for numerical vars -->
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="layers.html#cb34-1"></a><span class="kw">set.seed</span>(<span class="dv">231</span>)</span>
<span id="cb34-2"><a href="layers.html#cb34-2"></a>metro2<span class="op">$</span>group =<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">size =</span> <span class="kw">nrow</span>(metro2), <span class="dt">replace =</span> <span class="ot">TRUE</span>))</span></code></pre></div>
<p>Shapes allow representing different categories of point data.
They can be very generic, e.g., circle or square, just to be able to differentiate between categories, but often we use symbols that we associate with different types of features.
For example, we use the letter <em>P</em> for parking lots, <em>I</em> for information centers, an airplane symbol for airports, or a bus symbol for bus stops.</p>
<p>To use different shapes, we should use the <code>shape</code> argument in the <code>tm_symbols()</code> function.
It expects the name of the categorical variable.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="layers.html#cb35-1"></a><span class="kw">tm_shape</span>(metro2) <span class="op">+</span></span>
<span id="cb35-2"><a href="layers.html#cb35-2"></a><span class="st">  </span><span class="kw">tm_symbols</span>(<span class="dt">shape =</span> <span class="st">&quot;group&quot;</span>,</span>
<span id="cb35-3"><a href="layers.html#cb35-3"></a>             <span class="dt">title.shape =</span> <span class="st">&quot;Group:&quot;</span>,</span>
<span id="cb35-4"><a href="layers.html#cb35-4"></a>             <span class="dt">shapes.labels =</span> <span class="kw">c</span>(<span class="st">&quot;First&quot;</span>, <span class="st">&quot;Second&quot;</span>, <span class="st">&quot;Third&quot;</span>))</span></code></pre></div>
<p>By default, <strong>tmap</strong> uses symbols of filled circle, square, diamond, point-up triangle, and point-down triangle<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>.
However, it is also possible to customize used symbols, their title, and labels.
Legend title related to shapes is modified with the <code>title.shape</code> argument, while their labels use the <code>shapes.lables</code> argument.</p>
<p>Shapes can be specified with the <code>shapes</code> argument, that allows using one of three options.
The first one is a numeric value that specifies the plotting character of the symbol<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>.
A complete list of available symbols and their corresponding numbers is in the <code>?pch</code> function’s documentation.
<!--JN: or should we add a figure with them here??--></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="layers.html#cb36-1"></a><span class="kw">tm_shape</span>(metro2) <span class="op">+</span></span>
<span id="cb36-2"><a href="layers.html#cb36-2"></a><span class="st">  </span><span class="kw">tm_symbols</span>(<span class="dt">shape =</span> <span class="st">&quot;group&quot;</span>,</span>
<span id="cb36-3"><a href="layers.html#cb36-3"></a>             <span class="dt">shapes =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">5</span>))</span></code></pre></div>
<p>Second option is to use a <em>grob</em> object.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="layers.html#cb37-1"></a><span class="co"># library(grid)</span></span>
<span id="cb37-2"><a href="layers.html#cb37-2"></a><span class="co"># library(ggplotify)</span></span>
<span id="cb37-3"><a href="layers.html#cb37-3"></a><span class="co"># library(ggplot2)</span></span>
<span id="cb37-4"><a href="layers.html#cb37-4"></a><span class="co"># </span></span>
<span id="cb37-5"><a href="layers.html#cb37-5"></a><span class="co"># p1 = as.grob(~barplot(1:10))</span></span>
<span id="cb37-6"><a href="layers.html#cb37-6"></a><span class="co"># p2 = as.grob(expression(plot(rnorm(10))))</span></span>
<span id="cb37-7"><a href="layers.html#cb37-7"></a><span class="co"># p3 = as.grob(function() plot(sin))</span></span>
<span id="cb37-8"><a href="layers.html#cb37-8"></a><span class="co"># p4 = ggplotGrob(ggplot(data.frame(x = 1:10, y = 1:10), aes(x, y)) + geom_point())</span></span></code></pre></div>
<!-- explain what's a grob -->
<!-- try different codes (including the view mode) -->
<!-- add new example -->
<!-- A grob object, which can be a ggplot2 plot object created with ggplotGrob. To specify multiple shapes, a list of grob objects is required. See example of a proportional symbol map with ggplot2 plots. -->
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="layers.html#cb38-1"></a><span class="kw">tm_shape</span>(metro2) <span class="op">+</span></span>
<span id="cb38-2"><a href="layers.html#cb38-2"></a><span class="st">  </span><span class="kw">tm_symbols</span>(<span class="dt">shape =</span> <span class="st">&quot;group&quot;</span>,</span>
<span id="cb38-3"><a href="layers.html#cb38-3"></a>             <span class="dt">shapes =</span> my_icons)</span></code></pre></div>
<p>The last possibility is to use an icon specification created with the <code>tmap_icons()</code> function, that uses any png images.
The <code>tmap_icons()</code> function accepts a vector of file paths or urls, and also allows setting the width and height of the icon.
In our example, we have three distinct groups, therefore we need to create new icons based on three images - <code>icon1.png</code>, <code>icon2.png</code>, and <code>icon3.png</code> in this case.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="layers.html#cb39-1"></a>my_icons =<span class="st"> </span><span class="kw">tmap_icons</span>(<span class="kw">c</span>(<span class="st">&quot;images/icon1.png&quot;</span>, </span>
<span id="cb39-2"><a href="layers.html#cb39-2"></a>                        <span class="st">&quot;images/icon2.png&quot;</span>, </span>
<span id="cb39-3"><a href="layers.html#cb39-3"></a>                        <span class="st">&quot;images/icon3.png&quot;</span>))</span></code></pre></div>
<p>Now, we can use the prepared icons in the <code>shapes</code> argument (Figure <a href="layers.html#fig:tmsymshape">5.14</a>:D).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="layers.html#cb40-1"></a><span class="kw">tm_shape</span>(metro2) <span class="op">+</span></span>
<span id="cb40-2"><a href="layers.html#cb40-2"></a><span class="st">  </span><span class="kw">tm_symbols</span>(<span class="dt">shape =</span> <span class="st">&quot;group&quot;</span>,</span>
<span id="cb40-3"><a href="layers.html#cb40-3"></a>             <span class="dt">shapes =</span> my_icons)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:tmsymshape"></span>
<img src="05-layers_files/figure-html/tmsymshape-1.png" alt="Examples of two maps with different symbols: (A), (B), (C), and (D)." width="672" />
<p class="caption">
FIGURE 5.14: Examples of two maps with different symbols: (A), (B), (C), and (D).
</p>
</div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="layers.html#cb41-1"></a><span class="kw">tm_shape</span>(rivers) <span class="op">+</span><span class="st"> </span></span>
<span id="cb41-2"><a href="layers.html#cb41-2"></a><span class="st">  </span><span class="kw">tm_lines</span>(<span class="dt">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="05-layers_files/figure-html/tmlinlty-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="mixing-visual-variables" class="section level2">
<h2><span class="header-section-number">5.6</span> Mixing visual variables</h2>
<!--create all of the below examples, but maybe just show a few-->
<!-- 1. sequential symbols + size -->
<!-- 2. categorical symbols + size -->
<!-- 3. sequential symbols + shape -->
<!-- 4. categorical symbols + shape -->
<!-- 5. shape + size -->
<!-- 1. sequential lines + size -->
<!-- 2. categorical lines + size -->

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-birch_worldwide_2012">
<p>Birch, Jennifer. 2012. “Worldwide Prevalence of Red-Green Color Deficiency.” <em>Journal of the Optical Society of America A</em> 29 (3): 313. <a href="https://doi.org/10/ggkw82">https://doi.org/10/ggkw82</a>.</p>
</div>
<div id="ref-R-classInt">
<p>Bivand, Roger. 2020. <em>ClassInt: Choose Univariate Class Intervals</em>. <a href="https://CRAN.R-project.org/package=classInt">https://CRAN.R-project.org/package=classInt</a>.</p>
</div>
<div id="ref-borland_rainbow_2007">
<p>Borland, David, and Russell Taylor Ii. 2007. “Rainbow Color Map (Still) Considered Harmful.” <em>IEEE Computer Graphics and Applications</em> 27 (2): 14–17. <a href="https://doi.org/10/cf7nms">https://doi.org/10/cf7nms</a>.</p>
</div>
<div id="ref-carto_cartocolors_2019">
<p>CARTO. 2019. “CARTOColors Data-Driven Color Schemes.” https://carto.com/carto-colors/.</p>
</div>
<div id="ref-coombes_polychrome_2019">
<p>Coombes, Kevin R., Guy Brock, Zachary B. Abrams, and Lynne V. Abruzzo. 2019. “<strong>Polychrome</strong> : Creating and Assessing Qualitative Palettes with Many Colors.” <em>Journal of Statistical Software</em> 90 (Code Snippet 1). <a href="https://doi.org/10/ggkqvs">https://doi.org/10/ggkqvs</a>.</p>
</div>
<div id="ref-crameri_geodynamic_2018">
<p>Crameri, Fabio. 2018. “Geodynamic Diagnostics, Scientific Visualisation and StagLab 3.0.” <em>Geoscientific Model Development</em> 11 (6): 2541–62. <a href="https://doi.org/10/gdt4tg">https://doi.org/10/gdt4tg</a>.</p>
</div>
<div id="ref-fisher_grouping_1958">
<p>Fisher, Walter D. 1958. “On Grouping for Maximum Homogeneity.” <em>Journal of the American Statistical Association</em>, 10.</p>
</div>
<div id="ref-R-viridis">
<p>Garnier, Simon. 2018. <em>Viridis: Default Color Maps from ’Matplotlib’</em>. <a href="https://CRAN.R-project.org/package=viridis">https://CRAN.R-project.org/package=viridis</a>.</p>
</div>
<div id="ref-harrower_colorbrewer_2003">
<p>Harrower, Mark, and Cynthia A. Brewer. 2003. “ColorBrewer.Org: An Online Tool for Selecting Colour Schemes for Maps.” <em>The Cartographic Journal</em> 40 (1): 27–37. <a href="https://doi.org/10.1179/000870403235002042">https://doi.org/10.1179/000870403235002042</a>.</p>
</div>
<div id="ref-jiang_head_2013">
<p>Jiang, Bin. 2013. “Head/Tail Breaks: A New Classification Scheme for Data with a Heavy-Tailed Distribution.” <em>The Professional Geographer</em> 65 (3): 482–94. <a href="https://doi.org/10/f24r6j">https://doi.org/10/f24r6j</a>.</p>
</div>
<div id="ref-R-RColorBrewer">
<p>Neuwirth, Erich. 2014. <em>RColorBrewer: ColorBrewer Palettes</em>. <a href="https://CRAN.R-project.org/package=RColorBrewer">https://CRAN.R-project.org/package=RColorBrewer</a>.</p>
</div>
<div id="ref-R-rcartocolor">
<p>Nowosad, Jakub. 2018. <em>’CARTOColors’ Palettes</em>. <a href="https://nowosad.github.io/rcartocolor">https://nowosad.github.io/rcartocolor</a>.</p>
</div>
<div id="ref-nunez_optimizing_2018">
<p>Nuñez, Jamie R., Christopher R. Anderton, and Ryan S. Renslow. 2018. “Optimizing Colormaps with Consideration for Color Vision Deficiency to Enable Accurate Interpretation of Scientific Data.” Edited by Jesús Malo. <em>PLOS ONE</em> 13 (7): e0199239. <a href="https://doi.org/10/gdzkg4">https://doi.org/10/gdzkg4</a>.</p>
</div>
<div id="ref-R-scico">
<p>Pedersen, Thomas Lin, and Fabio Crameri. 2020. <em>Scico: Colour Palettes Based on the Scientific Colour-Maps</em>. <a href="https://CRAN.R-project.org/package=scico">https://CRAN.R-project.org/package=scico</a>.</p>
</div>
<div id="ref-quinan_examining_2019">
<p>Quinan, P. S., L. M. Padilla, S. H. Creem-Regehr, and M. Meyer. 2019. “Examining Implicit Discretization in Spectral Schemes.” <em>Computer Graphics Forum</em> 38 (3): 363–74. <a href="https://doi.org/10/ggb9nd">https://doi.org/10/ggb9nd</a>.</p>
</div>
<div id="ref-sharpe_opsin_1999">
<p>Sharpe, Lindsay T, Andrew Stockman, Herbert Jägle, and Jeremy Nathans. 1999. “Opsin Genes, Cone Photopigments, Color Vision, and Color Blindness.” In <em>Color Vision: From Genes to Perception</em>, edited by T Gegenfurtner and Lindsay T Sharpe, 50. Cambridge: Cambridge University Press.</p>
</div>
<div id="ref-stauffer_somewhere_2015">
<p>Stauffer, Reto, Georg J. Mayr, Markus Dabernig, and Achim Zeileis. 2015. “Somewhere over the Rainbow: How to Make Effective Use of Colors in Meteorological Visualizations.” <em>Bulletin of the American Meteorological Society</em> 96 (2): 203–16. <a href="https://doi.org/10/f3sttk">https://doi.org/10/f3sttk</a>.</p>
</div>
<div id="ref-wand_databased_1997">
<p>Wand, M. P. 1997. “Data-Based Choice of Histogram Bin Width.” <em>The American Statistician</em> 51 (1): 59. <a href="https://doi.org/10/fvsfdb">https://doi.org/10/fvsfdb</a>.</p>
</div>
<div id="ref-R-colorspace">
<p>Zeileis, Achim, Jason C. Fisher, Kurt Hornik, Ross Ihaka, Claire D. McWhite, Paul Murrell, Reto Stauffer, and Claus O. Wilke. 2019. “colorspace: A Toolbox for Manipulating and Assessing Colors and Palettes.” ArXiv 1903.06490. arXiv.org E-Print Archive. <a href="http://arxiv.org/abs/1903.06490">http://arxiv.org/abs/1903.06490</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>Other visual variables include position, orientation, and texture.<a href="layers.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Learn more about them at <a href="https://developer.r-project.org/Blog/public/2019/04/01/hcl-based-color-palettes-in-grdevices/" class="uri">https://developer.r-project.org/Blog/public/2019/04/01/hcl-based-color-palettes-in-grdevices/</a> and <a href="https://developer.r-project.org/Blog/public/2019/11/21/a-new-palette-for-r/index.html" class="uri">https://developer.r-project.org/Blog/public/2019/11/21/a-new-palette-for-r/index.html</a>.<a href="layers.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>To see and compare examples of every color scale style from <strong>tmap</strong> visit <a href="https://geocompr.github.io/post/2019/tmap-color-scales/" class="uri">https://geocompr.github.io/post/2019/tmap-color-scales/</a>.<a href="layers.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>The <code>tm_polygons(col = "region_un", style = "cat")</code> code is run automatically in this case.<a href="layers.html#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>For more information visit the <code>?pretty()</code> function documentation<a href="layers.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>The default value of size is 1, which corresponds to the area of symbols that have the same height as one line of text.<a href="layers.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>They are represented in R by numbers from 21 to 25.<a href="layers.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>However, this is not supported for the “view” mode.<a href="layers.html#fnref12" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<script>
/*
Sorts the references alphabetically.
Modified from code by Yvonne Aburrow.
*/
$(function(){
    var elems = $('#refs').children('div').remove();
    elems.sort(function (a, b) {
        return $(b).children('p').html().toUpperCase() > $(a).children('p').html().toUpperCase() ? -1 : 1;
    });
    $('#refs').append(elems);
})
</script>
            </section>

          </div>
        </div>
      </div>
<a href="tmshape.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="othertypes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mtennekes/tmap_book/edit/master/05-layers.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
